<div class="paddedWrapper">
    <div>
        <div class="row">
            <div class="analysisNameContainer"><label class="analysisName">Analysis name:</label></div>
            <div><input class="form-control analysisName" style="width: 500px;" type="text" data-bind="textInput: $component.analysis.description" /></div>
        </div>
    </div>
    <div id="filters" class="filter-group-bordered">
        <div class="row">
            <div class="filter-icon"><i class="fa fa-filter fa-2x"></i></div>
            <div>
                <ul class="nav nav-pills">
                <li role="presentation" data-bind="css: {active: $component.editorMode() == 'all' }, click: function() {$component.editorMode('all') };"><a>All</a></li>
                <li role="presentation" data-bind="css: {active: $component.editorMode() == 'outcome' }, click: function() {$component.editorMode('outcome') };"><a>Outcome Model</a></li>
                <li role="presentation" data-bind="css: {active: $component.editorMode() == 'timeAtRisk' }, click: function() {$component.editorMode('timeAtRisk') };"><a>Time At Risk</a></li>
                <li role="presentation" data-bind="css: {active: $component.editorMode() == 'studyPop' }, click: function() {$component.editorMode('studyPop') };"><a>Study Population</a></li>
                <li role="presentation" data-bind="css: {active: $component.editorMode() == 'psAdjustment' }, click: function() {$component.editorMode('psAdjustment') };"><a>Propensity Score Adjustment</a></li>
                <li role="presentation" data-bind="css: {active: $component.editorMode() == 'other' }, click: function() {$component.editorMode('other') };"><a>Other</a></li>
                </ul>
            </div>
        </div>
    </div>
    <div role="tabpanel" data-bind="visible: $component.editorMode() == 'all' || $component.editorMode() == 'outcome'" class="tab-pane">
        <div class="panel panel-primary">
            <div class="panel-heading">
                <i class="fa fa-cogs"></i> Outcome Model Settings
            </div>
            <div class="panel-body">
                <div>
                    <label>Fit outcome model?</label>
                    <div class="input-group">
                        <select class="form-control" data-bind="options: $component.options.yesNoOptions, optionsText:'name', optionsValue:'id', value: $component.analysis.fitOutcomeModel"></select>
                    </div>
                </div>
                <div data-bind="visible: $component.analysis.fitOutcomeModel()">
                    <outcome-model-args-editor params="outcomeModelArgs: $component.analysis.fitOutcomeModelArgs"></outcome-model-args-editor>
                </div>
            </div>
        </div>    
    </div>
    <div role="tabpanel" data-bind="visible: $component.editorMode() == 'all' || $component.editorMode() == 'timeAtRisk'" class="tab-pane">
        <div class="panel panel-primary">
            <div class="panel-heading">
                <i class="fa fa-clock-o" aria-hidden="true"></i> Time At Risk
            </div>
            <div class="panel-body">
                <div>
                    <label>Define the time-at-risk window start, relative to target/comparator cohort entry:</label>
                    <div class="input-group">
                        <span contenteditable="true" class="numericInputField dropdown" data-bind="htmlValue: $component.analysis.createStudyPopulationArgs.riskWindowStart, eventType:'blur', ko_autocomplete: { value: $component.analysis.createStudyPopulationArgs.riskWindowStart, source: $component.options.dayOptions, minLength: 0, maxShowItems: 10, scroll: true }" />
                    </div>
                </div>
                <div>
                    <label>Add the length of exposure the start of the risk window?</label>
                    <div class="input-group">
                        <select class="form-control" data-bind="options: $component.options.yesNoOptions, optionsText:'name', optionsValue:'id', value: $component.analysis.createStudyPopulationArgs.addExposureDaysToStart"></select>
                    </div>
                </div>
                <div>
                    <label>Define the time-at-risk window end:</label>
                    <div class="input-group">
                        <span contenteditable="true" class="numericInputField dropdown" data-bind="htmlValue: $component.analysis.createStudyPopulationArgs.riskWindowEnd, eventType:'blur', ko_autocomplete: { value: $component.analysis.createStudyPopulationArgs.riskWindowEnd, source: $component.options.dayOptions, minLength: 0, maxShowItems: 10, scroll: true }" />
                    </div>
                </div>
                <div>
                    <label>Add the length of exposure of the risk window?</label>
                    <div class="input-group">
                        <select class="form-control" data-bind="options: $component.options.yesNoOptions, optionsText:'name', optionsValue:'id', value: $component.analysis.createStudyPopulationArgs.addExposureDaysToEnd"></select>
                    </div>
                </div>
                <div>
                    <label>The minimum number of days at risk?</label>
                    <div class="input-group">
                        <span contenteditable="true" class="numericInputField dropdown" data-bind="htmlValue: $component.analysis.createStudyPopulationArgs.minDaysAtRisk, eventType:'blur', ko_autocomplete: { value: $component.analysis.createStudyPopulationArgs.minDaysAtRisk, source: $component.options.dayOptions, minLength: 0, maxShowItems: 10, scroll: true }" />
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div role="tabpanel" data-bind="visible: $component.editorMode() == 'all' || $component.editorMode() == 'studyPop'" class="tab-pane">
        <div class="panel panel-primary">
            <div class="panel-heading">
                <i class="fa fa-users" aria-hidden="true"></i> Study Population
            </div>
            <div class="panel-body">
                <div>
                    <label>Study start date - a calendar date specifying the minimum date that a cohort index can appear (leave blank to use all time):</label>
                    <div class="input-group">
                        <input placeholder="YYYY-MM-DD" class="form-control dateField" data-bind="datepicker:  $component.analysis.getDbCohortMethodDataArgs.studyStartDate, datepickerOptions: { defaultDate: new Date(), dateFormat: 'yy-mm-dd' }">
                    </div>
                </div>
                <div>
                    <label>Study end date - a calendar date specifying the maximum date that a cohort index can appear (leave blank to use all time). <b>Important</b>: the study end date is also used to truncate risk windows, meaning no outcomes beyond the study end date will be considered.</label>
                    <div class="input-group">
                        <input placeholder="YYYY-MM-DD" class="form-control dateField" data-bind="datepicker:  $component.analysis.getDbCohortMethodDataArgs.studyEndDate, datepickerOptions: { defaultDate: new Date(), dateFormat: 'yy-mm-dd' }">
                    </div>
                </div>
                <div>
                    <label>Should only the first exposure per subject be included?</label>
                    <div class="input-group">
                        <select class="form-control" data-bind="options: $component.options.yesNoOptions, optionsText:'name', optionsValue:'id', value: $component.analysis.getDbCohortMethodDataArgs.firstExposureOnly"></select>
                    </div>
                </div>
                <div>
                    <label>Remove subjects that are in both the target and comparator cohort?</label>
                    <div class="input-group">
                        <select class="form-control" data-bind="options: $component.options.removeDuplicateSubjectOptions, optionsText:'name', optionsValue:'id', value: $component.analysis.getDbCohortMethodDataArgs.removeDuplicateSubjects"></select>
                    </div>
                </div>
                <div>
                    <label>Restrict the analysis to the period when both exposures are observed?</label>
                    <div class="input-group">
                        <select class="form-control" data-bind="options: $component.options.yesNoOptions, optionsText:'name', optionsValue:'id', value: $component.analysis.getDbCohortMethodDataArgs.restrictToCommonPeriod"></select>
                    </div>
                </div>
                <div>
                    <label>The mininum required continuous observation time prior to index date for a person to be included in the cohort.</label>
                    <div class="input-group">
                        <span contenteditable="true" class="numericInputField dropdown" data-bind="htmlValue: $component.analysis.getDbCohortMethodDataArgs.washoutPeriod, eventType:'blur', ko_autocomplete: { value: $component.analysis.getDbCohortMethodDataArgs.washoutPeriod, source: $component.options.dayOptions, minLength: 0, maxShowItems: 10, scroll: true }" />
                    </div>
                </div>
                <div>
                    <label>The mininum required continuous observation time prior to index date for a person to be included in the cohort.</label>
                    <div class="input-group">
                        <span contenteditable="true" class="numericInputField dropdown" data-bind="htmlValue: $component.analysis.getDbCohortMethodDataArgs.maxCohortSize, eventType:'blur', ko_autocomplete: { value: $component.analysis.getDbCohortMethodDataArgs.maxCohortSize, source: $component.options.maxCohortSizeOptions, minLength: 0, maxShowItems: 10, scroll: true }" />
                    </div>
                </div>
                <div>
                    <label>Remove subjects that have the outcome prior to the risk window start?</label>
                    <div class="input-group">
                        <select class="form-control" data-bind="options: $component.options.yesNoOptions, optionsText:'name', optionsValue:'id', value: $component.analysis.createStudyPopulationArgs.removeSubjectsWithPriorOutcome"></select>
                    </div>
                </div>
                <div data-bind="visible: $component.analysis.createStudyPopulationArgs.removeSubjectsWithPriorOutcome()">
                    <label>How many days should we look back when identifying prior outcomes?</label>
                    <div class="input-group">
                        <span contenteditable="true" class="numericInputField dropdown" data-bind="htmlValue: $component.analysis.createStudyPopulationArgs.priorOutcomeLookback, eventType:'blur', ko_autocomplete: { value: $component.analysis.createStudyPopulationArgs.priorOutcomeLookback, source: $component.options.dayOptions, minLength: 0, maxShowItems: 10, scroll: true }" />
                    </div>
                </div>
                <div>
                    <label>If a subject is in multiple cohorts, should time-at-risk be censored when the new time-at-risk start to prevent overlap?</label>
                    <div class="input-group">
                        <select class="form-control" data-bind="options: $component.options.yesNoOptions, optionsText:'name', optionsValue:'id', value: $component.analysis.createStudyPopulationArgs.censorAtNewRiskWindow"></select>
                    </div>
                </div>
                <div>
                    <label>If more than one target is provided, this field should be used to select the specific target to use in this analysis. (leave blank to use for all targets):</label>
                    <div class="input-group">
                        <input class="form-control" type="text" data-bind="textInput: $component.analysis.targetType" />
                    </div>
                </div>
                <div>
                    <label>If more than one comparator is provided, this field should be used to select the specific comparator to use in this analysis. (leave blank to use for all comparators):</label>
                    <div class="input-group">
                        <input class="form-control" type="text" data-bind="textInput: $component.analysis.comparatorType" />
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div role="tabpanel" data-bind="visible: $component.editorMode() == 'all' || $component.editorMode() == 'psAdjustment'" class="tab-pane">
        <div class="panel panel-primary">
            <div class="panel-heading">
                <i class="fa fa-balance-scale" aria-hidden="true"></i> Propensity Score Adjustment
            </div>
            <div class="panel-body">
                <div>
                    <label>Use propensity score adjustment as a confounding adjustment strategy for baseline covariates?</label>
                    <div class="input-group">
                        <select class="form-control" data-bind="options: $component.options.yesNoOptions, optionsText:'name', optionsValue:'id', value: $component.analysis.createPs"></select>
                    </div>
                </div>
                <div data-bind="visible: $component.analysis.createPs">
                    <div>
                        <label><b>COVARIATE SETTINGS SELECTOR TO GO HERE</b></label>
                        <div class="input-group">
                            set GetDbCohortMethodDataArgs variable
                        </div>
                    </div>
                    <div>
                        <label><b>Concepts for inclusion/exclusion in the model TODO</b></label>
                    </div>
                    <div>
                        <label>Exclude covariate Ids:</label>
                        <div class="input-group">
                            <input class="form-control" type="text" data-bind="textInput: $component.analysis.createPsArgs.excludeCovariateIds" />
                        </div>
                    </div>
                    <div>
                        <label>Include covariate Ids:</label>
                        <div class="input-group">
                            <input class="form-control" type="text" data-bind="textInput: $component.analysis.createPsArgs.includeCovariateIds" />
                        </div>
                    </div>
                    <div>
                        <label>What is the maximum number of people to include in the propensity score model when fitting? Setting this number to 0 means no down-sampling will be applied:</label>
                        <div class="input-group">
                            <span contenteditable="true" class="numericInputField dropdown" data-bind="htmlValue: $component.analysis.createPsArgs.maxCohortSizeForFitting, eventType:'blur', ko_autocomplete: { value: $component.analysis.createPsArgs.maxCohortSizeForFitting, source: $component.options.maxCohortSizeForFittingOptions, minLength: 0, maxShowItems: 10, scroll: true }" />
                        </div>
                    </div>
                    <div>
                        <label>Test each covariate for correlation with the target assignment? If any covariate has an unusually high correlation (either positive or negative), this will throw an error.</label>
                        <div class="input-group">
                            <select class="form-control" data-bind="options: $component.options.yesNoOptions, optionsText:'name', optionsValue:'id', value: $component.analysis.createPs().errorOnHighCorrelation"></select>
                        </div>
                    </div>
                    <div>
                        <label>If an error occurs, should the function stop? Else, the two cohorts will be assumed to be perfectly separable.</label>
                        <div class="input-group">
                            <select class="form-control" data-bind="options: $component.options.yesNoOptions, optionsText:'name', optionsValue:'id', value: $component.analysis.createPs().stopOnError"></select>
                        </div>
                    </div>
                    <div>
                        <h4>Trimming</h4>
                    </div>
                    <div>
                        <label>How do you want to trim your cohorts based on the propensity score distribution?</label>
                        <div class="input-group">
                            <select class="form-control" data-bind="options: $component.options.trimOptions, optionsText:'name', optionsValue:'id', value: $component.trimSelection"></select>
                        </div>
                    </div>
                    <div data-bind="visible: $component.trimSelection() == 'byPercent'">
                        <label>Trim Fraction (1-100%):</label>
                        <div class="input-group">
                            <input class="form-control" type="text" data-bind="textInput: $component.analysis.trimByPsArgs.trimFraction" />
                        </div>
                    </div>
                    <div data-bind="visible: $component.trimSelection() == 'toEquipoise'">
                        <label>Bounds (1-100%):</label>
                        <div class="input-group">
                            <input class="form-control" type="text" data-bind="textInput: $component.analysis.trimByPsToEquipoiseArgs.bounds" />
                        </div>
                    </div>
                    <div>
                        <h4>Match/Stratify</h4>
                    </div>
                    <div>
                        <label>Do you want to perform matching or stratification?</label>
                        <div class="input-group">
                            <select class="form-control" data-bind="options: $component.options.matchStratifyOptions, optionsText:'name', optionsValue:'id', value: $component.matchStratifySelection"></select>
                        </div>
                    </div>
                    <div data-bind="visible: $component.matchStratifySelection() == 'matchOnPs'">
                        <match-args-editor params="matchArgs: $component.analysis.matchOnPsArgs"></match-args-editor>
                    </div>
                    <div data-bind="visible: $component.matchStratifySelection() == 'matchOnPsAndCovariates'">
                        <match-args-editor params="matchArgs: $component.analysis.matchOnPsAndCovariatesArgs"></match-args-editor>
                    </div>
                    <div data-bind="visible: $component.matchStratifySelection() == 'stratifyByPs'">
                        <stratify-args-editor params="stratifyArgs: $component.analysis.stratifyByPsArgs"></stratify-args-editor>
                    </div>
                    <div data-bind="visible: $component.matchStratifySelection() == 'stratifyOnPsAndCovariates'">
                        <stratify-args-editor params="stratifyArgs: $component.analysis.stratifyByPsAndCovariatesArgs"></stratify-args-editor>
                    </div>
                    <div class="row subsection">
                        <div class="col-md-6">
                            <div class="panel panel-primary">
                                <div class="panel-heading panel-subheading">
                                    <i class="fa fa-cogs"></i> Control Settings
                                </div>
                                <div class="panel-body">
                                    <cyclops-control-editor params="control: $component.analysis.createPsArgs.control"></cyclops-control-editor>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="panel panel-primary">
                                <div class="panel-heading panel-subheading">
                                    <i class="fa fa-cogs"></i> Prior
                                </div>
                                <div class="panel-body">
                                    <cyclops-prior-editor params="prior: $component.analysis.createPsArgs.prior"></cyclops-prior-editor>    
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
